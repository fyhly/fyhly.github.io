<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Hexo</title>
  
  
  <link href="http://example.com/atom.xml" rel="self"/>
  
  <link href="http://example.com/"/>
  <updated>2022-08-05T16:06:16.399Z</updated>
  <id>http://example.com/</id>
  
  <author>
    <name>John Doe</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>关注</title>
    <link href="http://example.com/2022/08/06/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/"/>
    <id>http://example.com/2022/08/06/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/</id>
    <published>2022-08-05T16:05:43.000Z</published>
    <updated>2022-08-05T16:06:16.399Z</updated>
    
    
    
    
    <category term="系统设计" scheme="http://example.com/categories/%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1/"/>
    
    
  </entry>
  
  <entry>
    <title>分布式锁</title>
    <link href="http://example.com/2022/08/06/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/"/>
    <id>http://example.com/2022/08/06/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/</id>
    <published>2022-08-05T16:03:58.000Z</published>
    <updated>2022-08-05T16:04:33.146Z</updated>
    
    
    
    
    <category term="分布式" scheme="http://example.com/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
    <category term="分布式锁" scheme="http://example.com/categories/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E9%94%81/"/>
    
    
  </entry>
  
  <entry>
    <title>分布式事务</title>
    <link href="http://example.com/2022/08/06/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/"/>
    <id>http://example.com/2022/08/06/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/</id>
    <published>2022-08-05T16:03:55.000Z</published>
    <updated>2022-08-05T16:04:33.141Z</updated>
    
    
    
    
    <category term="分布式" scheme="http://example.com/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
    <category term="分布式事务" scheme="http://example.com/categories/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/"/>
    
    
  </entry>
  
  <entry>
    <title>分布式缓存</title>
    <link href="http://example.com/2022/08/06/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98/"/>
    <id>http://example.com/2022/08/06/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98/</id>
    <published>2022-08-05T16:03:52.000Z</published>
    <updated>2022-08-05T16:04:33.126Z</updated>
    
    
    
    
    <category term="分布式" scheme="http://example.com/categories/%E5%88%86%E5%B8%83%E5%BC%8F/"/>
    
    <category term="分布式缓存" scheme="http://example.com/categories/%E5%88%86%E5%B8%83%E5%BC%8F/%E5%88%86%E5%B8%83%E5%BC%8F%E7%BC%93%E5%AD%98/"/>
    
    
  </entry>
  
  <entry>
    <title>工厂模式</title>
    <link href="http://example.com/2022/08/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2022/08/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F/</id>
    <published>2022-08-05T16:02:36.000Z</published>
    <updated>2022-08-05T16:03:29.985Z</updated>
    
    
    
    
    <category term="设计模式" scheme="http://example.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
  </entry>
  
  <entry>
    <title>单例模式</title>
    <link href="http://example.com/2022/08/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/"/>
    <id>http://example.com/2022/08/06/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F/</id>
    <published>2022-08-05T16:02:32.000Z</published>
    <updated>2022-08-05T16:03:30.004Z</updated>
    
    
    
    
    <category term="设计模式" scheme="http://example.com/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/"/>
    
    
  </entry>
  
  <entry>
    <title>DFS</title>
    <link href="http://example.com/2022/08/06/%E7%AE%97%E6%B3%95/DFS/"/>
    <id>http://example.com/2022/08/06/%E7%AE%97%E6%B3%95/DFS/</id>
    <published>2022-08-05T16:02:20.000Z</published>
    <updated>2022-08-05T16:03:29.994Z</updated>
    
    
    
    
    <category term="算法" scheme="http://example.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
  </entry>
  
  <entry>
    <title>BFS</title>
    <link href="http://example.com/2022/08/06/%E7%AE%97%E6%B3%95/BFS/"/>
    <id>http://example.com/2022/08/06/%E7%AE%97%E6%B3%95/BFS/</id>
    <published>2022-08-05T16:02:17.000Z</published>
    <updated>2022-08-05T16:03:30.000Z</updated>
    
    
    
    
    <category term="算法" scheme="http://example.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    
  </entry>
  
  <entry>
    <title>动态规划</title>
    <link href="http://example.com/2022/08/06/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    <id>http://example.com/2022/08/06/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</id>
    <published>2022-08-05T16:01:22.000Z</published>
    <updated>2022-08-05T16:02:09.800Z</updated>
    
    
    
    
    <category term="算法" scheme="http://example.com/categories/%E7%AE%97%E6%B3%95/"/>
    
    <category term="动态规划" scheme="http://example.com/categories/%E7%AE%97%E6%B3%95/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/"/>
    
    
  </entry>
  
  <entry>
    <title>netty</title>
    <link href="http://example.com/2022/08/06/%E6%A1%86%E6%9E%B6/netty/"/>
    <id>http://example.com/2022/08/06/%E6%A1%86%E6%9E%B6/netty/</id>
    <published>2022-08-05T16:01:04.000Z</published>
    <updated>2022-08-05T16:02:09.756Z</updated>
    
    
    
    
    <category term="框架" scheme="http://example.com/categories/%E6%A1%86%E6%9E%B6/"/>
    
    <category term="Netty" scheme="http://example.com/categories/%E6%A1%86%E6%9E%B6/Netty/"/>
    
    
  </entry>
  
  <entry>
    <title>HDFS</title>
    <link href="http://example.com/2022/08/06/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/HDFS/"/>
    <id>http://example.com/2022/08/06/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/HDFS/</id>
    <published>2022-08-05T16:00:00.000Z</published>
    <updated>2022-08-06T02:13:57.956Z</updated>
    
    <content type="html"><![CDATA[<h2 id="HDFS简介"><a href="#HDFS简介" class="headerlink" title="HDFS简介"></a>HDFS简介</h2><p>Hadoop 分布式文件系统 (HDFS) 是一种分布式文件系统，旨在在商用硬件上运行。它与现有的分布式文件系统有很多相似之处。但是，与其他分布式文件系统的区别是显着的。HDFS 具有高度容错性，旨在部署在低成本硬件上。HDFS 提供对应用程序数据的高吞吐量访问，适用于拥有大量数据集的应用程序。HDFS 放宽了一些 POSIX 要求，以支持对文件系统数据的流式访问。HDFS 最初是作为 Apache Nutch 网络搜索引擎项目的基础设施而构建的。HDFS 是 Apache Hadoop Core 项目的一部分。项目 URL 是<a href="http://hadoop.apache.org/%E3%80%82">http://hadoop.apache.org/。</a></p><h2 id="HDFS架构"><a href="#HDFS架构" class="headerlink" title="HDFS架构"></a>HDFS架构</h2><p><img src="/images/pasted-1.png" alt="HDFS架构"></p><h2 id="HDFS-1-0"><a href="#HDFS-1-0" class="headerlink" title="HDFS 1.0"></a>HDFS 1.0</h2><p><img src="/images/pasted-3.png" alt="HDFS 1.0架构"></p><h3 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h3><p><img src="/images/pasted-4.png" alt="HDFS 1.0组件"></p><ul><li>NameNode：<ul><li>维护整个文件系统的文件目录树，文件目录的元信息和文件数据块索引</li><li>以FsImage和EditLog形式存储在本地</li><li>整个系统的单点，存在SPOF（Simple Point of Failure）</li></ul></li><li>SecondaryNameNode：<ul><li>又名CheckPoint Node，定期合并FsImage和EditLog</li><li>不接收客户端的请求，作为NameNode的冷备</li></ul></li><li>DataNode：<ul><li>实际存储数据的单元</li><li>以Block为单位</li><li>数据以普通文件形式保存在本地文件系统</li></ul></li><li>Client：<ul><li>与HDFS交互，进行读写、创建目录、创建文件、复制、删除等操作</li><li>HDFS提供了多种客户端：命令行Shell、Java API、Thrift接口、C library、WebHDFS等</li></ul></li></ul><h3 id="NameNode"><a href="#NameNode" class="headerlink" title="NameNode"></a>NameNode</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>集群中单个NameNode的存在极大地简化了系统的架构。NameNode 是所有 HDFS 元数据的仲裁者和存储库。该系统的设计方式是用户数据永远不会流经 NameNode。</p><p>NameNode 维护文件系统命名空间。NameNode 记录对文件系统命名空间或其属性的任何更改。应用程序可以指定应该由 HDFS 维护的文件的副本数。文件的副本数称为该文件的复制因子。此信息由 NameNode 存储。</p><p>NameNode 做出有关块复制的所有决定。它定期从集群中的每个 DataNode 接收 Heartbeat 和 Blockreport。收到心跳意味着 DataNode 运行正常。Blockreport 包含 DataNode 上所有块的列表。</p><h4 id="持久化"><a href="#持久化" class="headerlink" title="持久化"></a>持久化</h4><p>HDFS 命名空间由 NameNode 存储。NameNode 使用称为 EditLog 的事务日志来持久记录文件系统元数据发生的每个更改。例如，在 HDFS 中创建一个新文件会导致 NameNode 将一条记录插入到 EditLog 中来表明这一点。同样，更改文件的复制因子会导致将新记录插入到 EditLog 中。NameNode 使用其本地主机操作系统文件系统中的文件来存储 EditLog。整个文件系统命名空间，包括块到文件的映射和文件系统属性，都存储在一个名为 FsImage 的文件中。FsImage 也作为文件存储在 NameNode 的本地文件系统中。</p><p>NameNode 在内存中保存了整个文件系统命名空间和文件 Blockmap 的图像。当 NameNode 启动，或者一个检查点被一个可配置的阈值触发时，它从磁盘读取 FsImage 和 EditLog，将 EditLog 中的所有事务应用到 FsImage 的内存表示中，并将这个新版本刷新到一个磁盘上的新 FsImage。然后它可以截断旧的 EditLog，因为它的事务已应用于持久 FsImage。这个过程称为检查点。检查点的目的是通过获取文件系统元数据的快照并将其保存到 FsImage 来确保 HDFS 具有文件系统元数据的一致视图。尽管读取 FsImage 是高效的，但直接对 FsImage 进行增量编辑并不高效。我们没有为每次编辑修改 FsImage，而是将编辑保存在 Editlog 中。在检查点期间，来自 Editlog 的更改将应用于 FsImage。可以在给定的时间间隔触发检查点（<code>dfs.namenode.checkpoint.period</code>）以秒表示，或者在累积给定数量的文件系统事务之后（<code>dfs.namenode.checkpoint.txns</code>）。如果设置了这两个属性，则要达到的第一个阈值会触发检查点。</p><p>DataNode 将 HDFS 数据存储在其本地文件系统中的文件中。DataNode 不了解 HDFS 文件。它将每个 HDFS 数据块存储在其本地文件系统中的单独文件中。DataNode 不会在同一目录中创建所有文件。相反，它使用启发式方法来确定每个目录的最佳文件数并适当地创建子目录。在同一目录中创建所有本地文件并不是最佳选择，因为本地文件系统可能无法有效地支持单个目录中的大量文件。当 DataNode 启动时，它会扫描其本地文件系统，生成与这些本地文件对应的所有 HDFS 数据块的列表，并将此报告发送给 NameNode。该报告称为<em>Blockreport</em>。</p><h3 id="SecondaryNameNode"><a href="#SecondaryNameNode" class="headerlink" title="SecondaryNameNode"></a>SecondaryNameNode</h3><p>NameNode 将文件系统的修改存储为附加到本机文件系统文件的日志。当 NameNode 启动时，它会从映像文件 FsImage 中读取 HDFS 状态，然后应用EditLog文件中的日志。然后它将新的 HDFS 状态写入 FsImage 并使用空的EditLog开始正常操作。由于 NameNode 仅在启动期间合并 FsImage 和EditLog，因此在繁忙的集群上，EditLog文件可能会随着时间变得非常大。较大的EditLog的另一个副作用是下次重新启动 NameNode 需要更长的时间。</p><p>SecondaryNameNode 定期合并 FsImage 和EditLog，并将EditLog保持在限制范围内。它通常在与主 NameNode 不同的机器上运行，因为它的内存需求与主 NameNode 的顺序相同。</p><p>SecondaryNameNode上检查点进程的启动由两个配置参数控制。</p><ul><li><code>dfs.namenode.checkpoint.period</code>，默认设置为 1 小时，指定两个连续检查点之间的最大延迟，以及</li><li><code>dfs.namenode.checkpoint.txns</code>默认设置为 100 万，定义 NameNode 上的未检查点事务的数量，这将强制执行紧急检查点，即使尚未达到检查点周期。</li></ul><p>SecondaryNameNode 将最新的检查点存储在一个目录中，该目录的结构与主 NameNode 的目录相同。这样检查点的图像总是准备好在必要时被主 NameNode 读取。</p><h3 id="DataNode"><a href="#DataNode" class="headerlink" title="DataNode"></a>DataNode</h3><p>DataNode将每个文件存储为一系列块。复制文件的块以实现容错。</p><p><img src="/images/pasted-5.png" alt="DateNode 存储"></p><h3 id="读写流程"><a href="#读写流程" class="headerlink" title="读写流程"></a>读写流程</h3><p><img src="/images/pasted-6.png" alt="HDFS 读写流程"></p><h3 id="存在的问题"><a href="#存在的问题" class="headerlink" title="存在的问题"></a>存在的问题</h3><ul><li>NameNode SPOF，NameNode挂掉整个集群不可用</li><li>内存受限，整个集群的size受限于NameNode的内存空间大小</li></ul><h2 id="HDFS-2-0"><a href="#HDFS-2-0" class="headerlink" title="HDFS 2.0"></a>HDFS 2.0</h2>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;HDFS简介&quot;&gt;&lt;a href=&quot;#HDFS简介&quot; class=&quot;headerlink&quot; title=&quot;HDFS简介&quot;&gt;&lt;/a&gt;HDFS简介&lt;/h2&gt;&lt;p&gt;Hadoop 分布式文件系统 (HDFS) 是一种分布式文件系统，旨在在商用硬件上运行。它与现有的分布式文件</summary>
      
    
    
    
    <category term="大数据" scheme="http://example.com/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
    <category term="hadoop" scheme="http://example.com/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/hadoop/"/>
    
    
  </entry>
  
  <entry>
    <title>jvm内存模型</title>
    <link href="http://example.com/2022/08/05/jvm/jvm%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"/>
    <id>http://example.com/2022/08/05/jvm/jvm%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/</id>
    <published>2022-08-05T15:59:40.000Z</published>
    <updated>2022-08-05T16:00:47.665Z</updated>
    
    
    
    
    <category term="JVM" scheme="http://example.com/categories/JVM/"/>
    
    <category term="内存模型" scheme="http://example.com/categories/JVM/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"/>
    
    
  </entry>
  
  <entry>
    <title>tidb</title>
    <link href="http://example.com/2022/08/05/%E5%A4%A7%E6%95%B0%E6%8D%AE/tidb/"/>
    <id>http://example.com/2022/08/05/%E5%A4%A7%E6%95%B0%E6%8D%AE/tidb/</id>
    <published>2022-08-05T15:59:19.000Z</published>
    <updated>2022-08-05T16:00:47.642Z</updated>
    
    
    
    
    <category term="大数据" scheme="http://example.com/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
    <category term="TiDB" scheme="http://example.com/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/TiDB/"/>
    
    
  </entry>
  
  <entry>
    <title>nio</title>
    <link href="http://example.com/2022/08/05/IO/nio/"/>
    <id>http://example.com/2022/08/05/IO/nio/</id>
    <published>2022-08-05T15:57:33.000Z</published>
    <updated>2022-08-05T15:58:54.655Z</updated>
    
    
    
    
    <category term="IO" scheme="http://example.com/categories/IO/"/>
    
    <category term="nio" scheme="http://example.com/categories/IO/nio/"/>
    
    
  </entry>
  
  <entry>
    <title>bio</title>
    <link href="http://example.com/2022/08/05/IO/bio/"/>
    <id>http://example.com/2022/08/05/IO/bio/</id>
    <published>2022-08-05T15:57:30.000Z</published>
    <updated>2022-08-05T15:58:54.652Z</updated>
    
    
    
    
    <category term="IO" scheme="http://example.com/categories/IO/"/>
    
    <category term="bio" scheme="http://example.com/categories/IO/bio/"/>
    
    
  </entry>
  
  <entry>
    <title>aio</title>
    <link href="http://example.com/2022/08/05/IO/aio/"/>
    <id>http://example.com/2022/08/05/IO/aio/</id>
    <published>2022-08-05T15:57:27.000Z</published>
    <updated>2022-08-05T15:58:54.650Z</updated>
    
    
    
    
    <category term="IO" scheme="http://example.com/categories/IO/"/>
    
    <category term="aio" scheme="http://example.com/categories/IO/aio/"/>
    
    
  </entry>
  
  <entry>
    <title>dubbo</title>
    <link href="http://example.com/2022/08/05/RPC/dubbo/"/>
    <id>http://example.com/2022/08/05/RPC/dubbo/</id>
    <published>2022-08-05T15:57:09.000Z</published>
    <updated>2022-08-05T15:58:54.648Z</updated>
    
    
    
    
    <category term="RPC" scheme="http://example.com/categories/RPC/"/>
    
    <category term="dubbo" scheme="http://example.com/categories/RPC/dubbo/"/>
    
    
  </entry>
  
  <entry>
    <title>ClickHouse</title>
    <link href="http://example.com/2022/08/05/%E5%A4%A7%E6%95%B0%E6%8D%AE/ClickHouse/"/>
    <id>http://example.com/2022/08/05/%E5%A4%A7%E6%95%B0%E6%8D%AE/ClickHouse/</id>
    <published>2022-08-05T15:55:35.000Z</published>
    <updated>2022-08-05T15:56:01.953Z</updated>
    
    
    
    
    <category term="大数据" scheme="http://example.com/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/"/>
    
    <category term="ClickHouse" scheme="http://example.com/categories/%E5%A4%A7%E6%95%B0%E6%8D%AE/ClickHouse/"/>
    
    
  </entry>
  
  <entry>
    <title>Mybatis</title>
    <link href="http://example.com/2022/08/05/%E6%A1%86%E6%9E%B6/Mybatis/"/>
    <id>http://example.com/2022/08/05/%E6%A1%86%E6%9E%B6/Mybatis/</id>
    <published>2022-08-05T15:54:03.000Z</published>
    <updated>2022-08-05T15:54:22.487Z</updated>
    
    
    
    
    <category term="框架" scheme="http://example.com/categories/%E6%A1%86%E6%9E%B6/"/>
    
    <category term="Mybatis" scheme="http://example.com/categories/%E6%A1%86%E6%9E%B6/Mybatis/"/>
    
    
  </entry>
  
  <entry>
    <title>SpringCloud</title>
    <link href="http://example.com/2022/08/05/%E6%A1%86%E6%9E%B6/SpringCloud/"/>
    <id>http://example.com/2022/08/05/%E6%A1%86%E6%9E%B6/SpringCloud/</id>
    <published>2022-08-05T15:53:07.000Z</published>
    <updated>2022-08-05T15:53:57.979Z</updated>
    
    
    
    
    <category term="框架" scheme="http://example.com/categories/%E6%A1%86%E6%9E%B6/"/>
    
    <category term="SpringCloud" scheme="http://example.com/categories/%E6%A1%86%E6%9E%B6/SpringCloud/"/>
    
    
  </entry>
  
</feed>
